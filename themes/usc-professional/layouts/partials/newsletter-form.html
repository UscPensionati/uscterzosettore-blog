<!-- Newsletter Signup Form -->
<div class="newsletter-form-container">
    
    <!-- ConvertKit Form (da configurare con il tuo account) -->
    <form class="newsletter-form" action="#" method="post" id="newsletter-form">
        <div class="form-group">
            <div class="input-wrapper">
                <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                    <polyline points="22,6 12,13 2,6"></polyline>
                </svg>
                <input 
                    type="email" 
                    name="email" 
                    placeholder="mario.rossi@email.com" 
                    required 
                    class="email-input"
                    aria-label="Indirizzo email"
                >
            </div>
            <button type="submit" class="subscribe-button">
                ISCRIVITI ORA
            </button>
        </div>
        
        <!-- Privacy Consent -->
        <div class="privacy-consent">
            <label class="consent-label">
                <input type="checkbox" name="consent" required class="consent-checkbox">
                <span class="consent-text-white">
                    Accetto la <a href="{{ "/privacy/" | relURL }}" target="_blank">Privacy Policy</a> 
                    e desidero ricevere la newsletter di USC.
                </span>
            </label>
        </div>
        
        <!-- Hidden fields for tracking -->
        <input type="hidden" name="source" value="website">
        <input type="hidden" name="utm_source" value="blog">
    </form>
    
    <!-- Success/Error Messages -->
    <div class="form-messages">
        <div class="success-message" id="success-message" style="display: none;">
            <svg class="message-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20,6 9,17 4,12"></polyline>
            </svg>
            <span>Grazie! La tua iscrizione è stata confermata.</span>
        </div>
        
        <div class="error-message" id="error-message" style="display: none;">
            <svg class="message-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="15" y1="9" x2="9" y2="15"></line>
                <line x1="9" y1="9" x2="15" y2="15"></line>
            </svg>
            <span>Si è verificato un errore. Riprova più tardi.</span>
        </div>
        
        <div class="loading-message" id="loading-message" style="display: none;">
            <svg class="loading-spinner" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12a9 9 0 11-6.219-8.56"/>
            </svg>
            <span>Iscrizione in corso...</span>
        </div>
    </div>
    
</div>

<!-- Newsletter Form JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('newsletter-form');
    const successMessage = document.getElementById('success-message');
    const errorMessage = document.getElementById('error-message');
    const loadingMessage = document.getElementById('loading-message');
    
    if (form) {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Show loading
            showMessage(loadingMessage);
            
            const formData = new FormData(form);
            const email = formData.get('email');
            
            // Simulated form submission (sostituire con ConvertKit API)
            setTimeout(() => {
                hideAllMessages();
                
                if (email && email.includes('@')) {
                    showMessage(successMessage);
                    form.reset();
                    
                    // Track conversion (Google Analytics)
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'newsletter_signup', {
                            'event_category': 'engagement',
                            'event_label': 'footer_form'
                        });
                    }
                } else {
                    showMessage(errorMessage);
                }
            }, 1500);
        });
    }
    
    function showMessage(element) {
        hideAllMessages();
        element.style.display = 'flex';
    }
    
    function hideAllMessages() {
        successMessage.style.display = 'none';
        errorMessage.style.display = 'none';
        loadingMessage.style.display = 'none';
    }
});
</script>